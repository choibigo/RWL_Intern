<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>네이버 주식 거래 상위 30</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;
        }
        th {
            cursor: pointer;
        }
    </style>
</head>
<body>

<h2>거래량 상위 30</h2>



<script>
   let company_data;
   fetch("C:/anaconda3 for study/gitgit/RWL_Intern/docs/md/junhea_workspace/crawling/new_ver/company_name.json")
      .then(response => response.json())
      .then(json => {
         company_data = json;
         console.log(company_data);
      })
      .catch(error => console.error('Error:', error));
   const rowCnt = 955;
   const columnCnt = 18;
   document.write('<table border="1">');
   document.write('<tr>');
   document.write('<th onclick="sortTable(0)">');
   document.write('회사 이름');
   document.write('</th>');
   document.write('<th onclick="sortTable(1)">');
   document.write('전일 가격');
   document.write('</th>');
   document.write('<th onclick="sortTable(2)">');
   document.write('시작 가격');
   document.write('</th>');
   document.write('<th onclick="sortTable(3)">');
   document.write('당일 최고가');
   document.write('</th>');
   document.write('<th onclick="sortTable(4)">');
   document.write('당일 최저가');
   document.write('</th>');
   document.write('<th onclick="sortTable(5)">');
   document.write('거래량');
   document.write('</th>');
   document.write('<th onclick="sortTable(6)">');
   document.write('대금');
   document.write('</th>');
   document.write('<th onclick="sortTable(7)">');
   document.write('시가 총액');
   document.write('</th>');
   document.write('<th onclick="sortTable(8)">');
   document.write('외인소진율');
   document.write('</th>');
   document.write('<th onclick="sortTable(9)">');
   document.write('52주 최고가');
   document.write('</th>');
   document.write('<th onclick="sortTable(10)">');
   document.write('52주 최저가');
   document.write('</th>');
   document.write('<th onclick="sortTable(11)">');
   document.write('PER');
   document.write('</th>');
   document.write('<th onclick="sortTable(12)">');
   document.write('EPS');
   document.write('</th>');
   document.write('<th onclick="sortTable(13)">');
   document.write('추정PER');
   document.write('</th>');
   document.write('<th onclick="sortTable(14)">');
   document.write('추정EPS');
   document.write('</th>');
   document.write('<th onclick="sortTable(15)">');
   document.write('PBR');
   document.write('</th>');
   document.write('<th onclick="sortTable(16)">');
   document.write('BPS');
   document.write('</th>');
   document.write('<th onclick="sortTable(17)">');
   document.write('배당수익률');
   document.write('</th>');
   document.write('<th onclick="sortTable(18)">');
   document.write('주당배당금');
   document.write('</th>');
   document.write('</tr>');
   for (let i = 1; i < rowCnt; i++) {
      var k = string(i);
      document.write('<tr>');
      document.write('<td>');
      document.write(company_data[k]["stockName"]);
      document.write('</td>');
      for (let j = 0; j < columnCnt; j++)  {
         document.write('<td>');
         document.write(company_data[k]["totalInfos"][j]["value"]);
         document.write('</td>');
      }
      document.write('</tr>')
   }
   document.write('</table>');
    function sortTable(colInd) {
        var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
        table = document.getElementById("sortableTable");
        switching = true;
        // 초기 정렬 방향은 오름차순
        dir = "asc";
        while (switching) {
            switching = false;
            rows = table.rows;
            for (i = 1; i < (rows.length - 1); i++) {
                shouldSwitch = false;
                x = rows[i].getElementsByTagName("td")[colInd];
                y = rows[i + 1].getElementsByTagName("td")[colInd];
                if (dir == "asc") {
                    if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                        shouldSwitch= true;
                        break;
                    }
                } else if (dir == "desc") {
                    if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
                        shouldSwitch= true;
                        break;
                    }
                }
            }
            if (shouldSwitch) {
                rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                switching = true;
                switchcount ++;
            } else {
                if (switchcount == 0 && dir == "asc") {
                    dir = "desc";
                    switching = true;
                }
            }
        }
    }
</script>

</body>
</html>